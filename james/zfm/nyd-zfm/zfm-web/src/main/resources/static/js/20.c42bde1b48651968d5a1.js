webpackJsonp([20],{P3pw:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("cMGX"),s=a("gyMJ"),n=((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate(),{data:function(){return{options:[{value:0,label:"待处理"},{value:1,label:"处理中"},{value:2,label:"已退款"},{value:3,label:"退款失败"},{value:4,label:"拒绝"}],refundId:"",userId:"",sumInfo:{},dialogvisible:!1,refundDate:[],formData:{name:"",phone:"",status:null,pageSize:10,pageNo:1},tableData:[],currentPage:1,total:0,backform:{result:1,cashnum:"",remark:""},backformRules:{cashnum:[{required:!0,message:"请填写金额",trigger:"blur"},{pattern:/^\d\.([1-9]{1,2}|[0-9][1-9])$|^[1-9]\d{0,1}(\.\d{1,2}){0,1}$|^99(\.0{1,2}){0,1}$/,message:"输入大于0小于99的金额",trigger:"blur"}]}}},created:function(){this.getTime()},mounted:function(){this.refundList(),this.refundRatio()},methods:{refundDateChange:function(e){},getTime:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,r=e.getDate();a<10&&(a="0"+a),r<10&&(r="0"+r);var s=t+"-"+a+"-"+r;this.refundDate=[s,s]},refundMoney:function(){var e=this;s.a.refundMoney({userId:this.userId,refundId:this.refundId,isResult:this.backform.result,refundAmount:this.backform.cashnum,remark:this.backform.remark}).then(function(t){t.data.success?(e.$message({message:t.data.msg,type:"success"}),e.dialogvisible=!1,e.$refs.backform.resetFields(),e.refundList()):e.$message({message:t.data.msg,type:"error"})})},submitBtn:function(){var e=this;this.$refs.backform.validate(function(t){t&&e.refundMoney()})},refundRatio:function(){var e=this;s.a.refundRatio().then(function(t){t.data.success&&(e.sumInfo=t.data.data)})},lookDetail:function(e){var t=this.$router.resolve({path:"/refundOrderDetail",query:{orderNo:e.orderNo,status:e.orderStatus,custName:e.name,userId:e.userId,operate:!0,custIdRepore:e.custId}});window.open(t.href)},reback:function(e){this.dialogvisible=!0,this.refundId=e.id,this.userId=e.userId,this.backform.cashnum=e.refundAmount},search:function(){this.formData.pageNo=1,this.formData.pageSize=10,this.currentPage=1,this.refundList()},refundList:function(){var e=this;this.refundDate&&this.refundDate.length>0?(this.formData.beginTime=this.refundDate[0],this.formData.endTime=this.refundDate[1]):(this.formData.beginTime="",this.formData.endTime=""),s.a.refundList(this.formData).then(function(t){if(t.data.success)for(var a in e.tableData=t.data.data,e.tableData)switch(e.tableData[a].status){case"0":e.tableData[a].statusName="待处理";break;case"1":e.tableData[a].statusName="处理中";break;case"2":e.tableData[a].statusName="已退款";break;case"3":e.tableData[a].statusName="退款失败";break;case"4":e.tableData[a].statusName="拒绝";break;default:e.tableData[a].statusName="--"}e.total=t.data.total})},handleSizeChange:function(e){this.currentPage=1,this.formData.pageNo=1,this.formData.pageSize=e,this.refundList()},handleCurrentChange:function(e){this.formData.pageNo=e,this.formData.currentPage=e,this.refundList()}},components:{Pagination:r.a}}),l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"approval-orders common-query"},[a("el-card",[a("div",{staticClass:"border-1px padding-10px"},[a("div",{staticClass:"common-reset-inptu"},[a("span",[e._v("客户姓名：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}}),e._v(" "),a("span",{staticClass:"common-label-text"},[e._v("手机号码：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.formData.phone,callback:function(t){e.$set(e.formData,"phone",t)},expression:"formData.phone"}}),e._v(" "),a("span",{staticClass:"common-label-text"},[e._v("退款时间：")]),e._v(" "),a("el-date-picker",{attrs:{type:"daterange",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(t){return e.refundDateChange()}},model:{value:e.refundDate,callback:function(t){e.refundDate=t},expression:"refundDate"}}),e._v(" "),a("br"),e._v(" "),a("span",{staticClass:"common-label-text",staticStyle:{margin:"15px 0 0 0"}},[e._v("退款结果：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("div",{staticClass:"common-flex-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.search()}}},[e._v("查询")])],1)],1),e._v(" "),a("div",{staticClass:"common-reset-inptu"},[a("ul",[a("li",[a("strong",[e._v("今日共收入：")]),e._v(" "),a("span",{staticClass:"money"},[e._v(e._s(e.sumInfo.totalIncome))]),e._v(" "),a("span",{staticClass:"money-text"},[e._v(" 元")])]),e._v(" "),a("li",[a("strong",[e._v("已退款：")]),e._v(" "),a("span",{staticClass:"money",staticStyle:{color:"red"}},[e._v(e._s(e.sumInfo.refunded))]),e._v(" "),a("span",{staticClass:"money-text"},[e._v(" 元")])]),e._v(" "),a("li",[a("strong",[e._v("退款比例："+e._s(e.sumInfo.refundRatio)+"%")])])])])]),e._v(" "),a("div",{staticClass:"common-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"refundDate",label:"期望退款时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"statusName",label:"退款结果",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"customerName",label:"客服",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"refundAmount",label:"申请退款金额"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"name",label:"客户姓名"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"phone",label:"手机号码"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"orderNo",width:"180",label:"贷款编号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.lookDetail(t.row)}}},[e._v("查看详情")]),e._v(" "),"0"==t.row.status||"3"==t.row.status?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.reback(t.row)}}},[e._v("退款")]):a("el-button",{attrs:{type:"text",disabled:""}},[e._v("退款")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination_wrap com_cen"},[a("Pagination",{attrs:{currentPage:e.currentPage,total:e.total,myPageSizes:e.formData.pageSize},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"退款",visible:e.dialogvisible,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(t){e.dialogvisible=t}}},[a("el-form",{ref:"backform",attrs:{model:e.backform,"label-width":"100px",rules:e.backformRules}},[a("el-form-item",{attrs:{label:"结果：",required:""}},[a("el-radio",{attrs:{label:1},model:{value:e.backform.result,callback:function(t){e.$set(e.backform,"result",t)},expression:"backform.result"}},[e._v("同意退款")]),e._v(" "),a("el-radio",{attrs:{label:0},model:{value:e.backform.result,callback:function(t){e.$set(e.backform,"result",t)},expression:"backform.result"}},[e._v("拒绝退款")])],1),e._v(" "),"1"==e.backform.result?a("el-form-item",{attrs:{label:"金额：",prop:"cashnum"}},[a("el-input",{model:{value:e.backform.cashnum,callback:function(t){e.$set(e.backform,"cashnum",t)},expression:"backform.cashnum"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:e.backform.remark,callback:function(t){e.$set(e.backform,"remark",t)},expression:"backform.remark"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogvisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitBtn()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var o=a("C7Lr")(n,l,!1,function(e){a("se4I")},"data-v-08f8a251",null);t.default=o.exports},se4I:function(e,t){}});